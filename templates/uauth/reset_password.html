{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>비밀번호 찾기</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: "Pretendard", sans-serif;
  }
  input {
    font-size: 18px;
    font-family: "Pretendard", sans-serif;
    color: #56609B;
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    outline: none;
    width: 560px;
  }
  button {
    cursor: pointer;
  }
  .feedback.error { color: red; font-size: 14px; margin-top: 4px; }
  .feedback.success { color: green; font-size: 14px; margin-top: 4px; }

  /* ✅ 전체 비율 축소 추가 */
  .scale-wrapper {
    transform: scale(0.7);       /* 비율 (0.7 → 더 작게 하려면 0.6, 더 크게 하려면 0.8) */
    transform-origin: center; /* 위쪽 중앙 기준으로 축소 */
  }
</style>
</head>
<body>

<!-- ✅ 추가: 전체를 감쌀 래퍼 -->
<div class="scale-wrapper">

<form method="post" action="{% url 'uauth:signup' %}" enctype="multipart/form-data">
{% csrf_token %}
<div style="width: 756px; height: 868px; position: relative; border-radius: 30px">
  <!-- 바탕 -->
  <div style="width: 756px; height: 868px; left: 0px; top: 0px; position: absolute; background: white; border-radius: 30px"></div>

  <!-- 제목 -->
  <div style="width: 629px; height: 103px; left: 63px; top: 32px; position: absolute; display: flex; align-items: center; color: #56609B; font-size: 48px; font-weight: 600;">회원가입</div>

  <!-- 이메일 입력 -->
  <div style="width: 393px; height: 40px; left: 78px; top: 165px; position: absolute; color: #56609B; font-size: 24px; font-weight: 600;">이메일 입력</div>
  <div style="width: 613px; height: 75px; left: 63px; top: 213px; position: absolute; border-radius: 30px; border: 1.5px #56609B solid;"></div>
  <input type="email" name="email" id="email"
         placeholder="이메일을 입력해 주세요."
         value="{{ form.email.value|default:'' }}"
         style="position: absolute; left: 90px; top: 228px; z-index: 10;">
  <sub id="email-feedback" class="feedback" style="position:absolute; left:94px; top:290px;"></sub>

  <!-- 인증번호 전송 -->
  <div style="width: 613px; height: 75px; left: 63px; top: 304px; position: absolute; background: #56609B; border-radius: 30px;"></div>
  <div style="width: 472px; height: 69px; left: 134px; top: 307px; position: absolute; text-align: center; display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: 500;">인증번호 전송하기</div>

  <!-- 비밀번호 -->
  <div style="width: 393px; height: 40px; left: 78px; top: 417px; position: absolute; color: #56609B; font-size: 24px; font-weight: 600;">비밀번호 재설정</div>
  <div style="width: 613px; height: 75px; left: 63px; top: 465px; position: absolute; border-radius: 30px; border: 1.5px #56609B solid;"></div>
  <input type="password" name="password1" id="password1"
         placeholder="비밀번호를 입력해 주세요."
         value="{{ form.password1.value|default:'' }}"
         style="position: absolute; left: 90px; top: 480px; z-index: 10;">

  <!-- 비밀번호 확인 -->
  <div style="width: 613px; height: 75px; left: 63px; top: 560px; position: absolute; border-radius: 30px; border: 1.5px #56609B solid;"></div>
  <input type="password" name="password2" id="password2"
         placeholder="비밀번호 확인"
         value="{{ form.password2.value|default:'' }}"
         style="position: absolute; left: 90px; top: 575px; z-index: 10;">
  <div id="password-feedback" class="feedback" style="position:absolute; left:90px; top:650px;">
    영문 대/소문자, 숫자, 특수문자(!?~@#$%&^) 두 종류 이상 혼용되어야 함.<br>
    8~16자 사이, 연속된 숫자 혹은 동일 숫자의 반복은 설정 불가함.
  </div>

  <!-- 가입하기 버튼 -->
  <div style="width: 328px; height: 65px; left: 340px; top: 743px; position: absolute; background: #56609B; border-radius: 30px;"></div>
  <button type="submit"
          style="position: absolute; left: 417px; top: 754px; width: 174px; height: 44px; background:none; color:white; font-size:26px; font-weight:600; border:none; z-index:10;">
    가입하기
  </button>

  <!-- 안내 -->
  <div style="width: 246px; height: 44px; left: 78px; top: 754px; position: absolute; display: flex; align-items: center; color: #56609B; font-size: 22px; font-weight: 400;">계정이 있으신가요?</div>
</div>
</form>

</div> <!-- ✅ scale-wrapper 닫기 -->

<script>
document.addEventListener('DOMContentLoaded', () => {
  const pw1 = document.getElementById('password1');
  const pw2 = document.getElementById('password2');
  const feedback = document.getElementById('password-feedback');

  function validatePassword(pw) {
    const errors = [];
    if (pw.length < 8 || pw.length > 16) {
      errors.push("8~16자 사이여야 합니다.");
    }
    const hasUpper = /[A-Z]/.test(pw);
    const hasLower = /[a-z]/.test(pw);
    const hasNumber = /[0-9]/.test(pw);
    const hasSpecial = /[!?~@#$%&^]/.test(pw);
    const types = [hasUpper, hasLower, hasNumber, hasSpecial].filter(v => v).length;
    if (types < 2) {
      errors.push("영문, 숫자, 특수문자 중 2가지 이상 혼용해야 합니다.");
    }
    if (/(012|123|234|345|456|567|678|789|890|111|222|333|444|555|666|777|888|999)/.test(pw)) {
      errors.push("연속된 숫자 혹은 동일 숫자 반복은 불가합니다.");
    }
    return errors;
  }

  function updateFeedback() {
    const pw = pw1.value;
    const pwCheck = pw2.value;
    const errors = validatePassword(pw);

    if (errors.length > 0) {
      feedback.classList.remove('success');
      feedback.classList.add('error');
      feedback.innerHTML = errors.join('<br>');
    } else if (pw && pwCheck && pw !== pwCheck) {
      feedback.classList.remove('success');
      feedback.classList.add('error');
      feedback.innerHTML = "비밀번호가 일치하지 않습니다.";
    } else if (pw && pw === pwCheck) {
      feedback.classList.remove('error');
      feedback.classList.add('success');
      feedback.innerHTML = "사용 가능한 비밀번호입니다.";
    } else {
      feedback.innerHTML = "";
    }
  }

  pw1.addEventListener('input', updateFeedback);
  pw2.addEventListener('input', updateFeedback);

  const form = document.querySelector('form');
    form.addEventListener('submit', (e) => {
        const errors = validatePassword(pw1.value);
        if (errors.length > 0 || pw1.value !== pw2.value) {
        e.preventDefault();
        alert("비밀번호 조건을 확인하세요.");
        }
    });
});
</script>

</body>
</html>
